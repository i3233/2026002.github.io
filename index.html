<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026æ–°é¡¹ç›®äºŒ - SaaSåå°ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/Main.css">
    <style>
        /* è¿”å›å¡ç‰‡æŒ‰é’®æ ·å¼ */
        .back-to-cards-btn {
            display: inline-flex;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            background-color: var(--color-primary);
            color: #ffffff;
            text-decoration: none;
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            transition: all var(--transition-base) var(--ease-in-out);
            cursor: pointer;
            border: none;
        }

        .back-to-cards-btn:hover {
            background-color: var(--color-primary-hover);
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .back-to-cards-btn:active {
            background-color: var(--color-primary-active);
            transform: translateY(0);
        }

        /* ä¾§è¾¹æ æ ‡é¢˜é“¾æ¥æ ·å¼ */
        .sidebar-title-link {
            display: block;
            text-decoration: none;
            color: inherit;
            cursor: pointer;
            transition: opacity var(--transition-base) var(--ease-in-out);
        }

        .sidebar-title-link:hover {
            opacity: 0.8;
        }

        .sidebar-title-link .sidebar-title {
            margin: 0;
            color: #ffffff;
        }

        /* å•†è¶…æ¨¡å—å¸ƒå±€æ ·å¼ï¼ˆå‚è€ƒå•†å“åˆ†ç±»é¡µé¢ï¼‰ */
        .module-layout-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: var(--color-neutral-50);
            padding: var(--spacing-lg);
            gap: var(--spacing-lg);
        }

        /* ä¸€çº§èœå•æ¨ªå‘æ˜¾ç¤º */
        .level1-menu {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            flex-wrap: wrap;
        }

        .level1-menu-item {
            padding: var(--spacing-sm) var(--spacing-lg);
            border: 1px solid var(--color-neutral-300);
            background-color: #ffffff;
            color: var(--color-text-primary);
            font-size: var(--font-size-base);
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all var(--transition-base) var(--ease-in-out);
            white-space: nowrap;
        }

        .level1-menu-item:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .level1-menu-item.active {
            background-color: var(--color-primary);
            color: #ffffff;
            border-color: var(--color-primary);
        }

        /* ä¸»å†…å®¹åŒº */
        .module-main-content-area {
            flex: 1;
            display: flex;
            gap: var(--spacing-lg);
            overflow: hidden;
            min-height: 0;
        }

        /* å·¦ä¾§äºŒçº§èœå• */
        .level2-sidebar {
            width: 200px;
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            padding: var(--spacing-md);
            overflow-y: auto;
            flex-shrink: 0;
        }

        .level2-sidebar-title {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--color-neutral-200);
        }

        .level2-sidebar-item {
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--color-text-primary);
            font-size: var(--font-size-base);
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all var(--transition-base) var(--ease-in-out);
            margin-bottom: var(--spacing-xs);
            display: block;
            text-decoration: none;
        }

        .level2-sidebar-item:hover {
            background-color: var(--color-neutral-50);
            color: var(--color-primary);
        }

        .level2-sidebar-item.active {
            background-color: rgba(44, 131, 235, 0.1);
            color: var(--color-primary);
            font-weight: var(--font-weight-medium);
        }

        /* å³ä¾§å†…å®¹åŒº */
        .module-content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            min-width: 0;
        }

        .module-content-iframe {
            flex: 1;
            width: 100%;
            border: none;
            min-height: 0;
        }
        /* è¦†ç›–é¦–é¡µå·¦ä¾§â€œåº”ç”¨â€æ ‡é¢˜èƒŒæ™¯ä¸ºç™½è‰²ï¼Œæ— è“åº• */
        .sidebar-header {
            background-color: #ffffff;
            color: var(--color-text-primary);
        }
        /* åº”ç”¨å¤§å… / æ¨¡å—æ¨¡å¼å¸ƒå±€å¼€å…³ */
        .content-title-container {
            display: none;
        }
        .app-module-mode .content-title-container {
            display: block;
        }
        .app-module-mode .sidebar {
            display: none;
        }
        .app-module-mode .main-content {
            width: 100%;
        }
        /* æ¨¡å—æ¨¡å¼ä¸‹å¾®è°ƒæ ‡é¢˜ä¸è¿”å›æŒ‰é’®ä½ç½® */
        .app-module-mode .content-header {
            padding-left: 0;
            padding-right: 0;
        }
        .app-module-mode .breadcrumb-container {
            padding-left: 50px;
        }
        .app-module-mode .content-title-container {
            padding-left: 50px;
            padding-right: 100px; /* è®©â€œè¿”å›åº”ç”¨â€ç›¸å¯¹é¡µé¢å³ä¾§å†å¾€å·¦ç§» 50px */
        }
        /* æ¨¡å—å…¥å£å¡ç‰‡æ ·å¼ */
        .module-entry-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--spacing-lg);
            padding: var(--spacing-xl);
        }

        .module-entry-card {
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            padding: var(--spacing-xl);
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-in-out);
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 200px;
            justify-content: center;
            position: relative;
            z-index: 1;
            user-select: none;
        }

        .module-entry-card:hover {
            border-color: var(--color-primary);
            box-shadow: var(--shadow-card-hover);
            transform: translateY(-4px);
        }

        .module-entry-card-icon {
            font-size: 48px;
            margin-bottom: var(--spacing-md);
            display: block;
        }

        .module-entry-card-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0 0 var(--spacing-xs) 0;
        }

        .module-entry-card-desc {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin: 0;
            line-height: var(--line-height-relaxed);
        }

        .module-entry-header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-xl);
        }

        .module-entry-title {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0 0 var(--spacing-sm) 0;
        }

        .module-entry-subtitle {
            font-size: var(--font-size-lg);
            color: var(--color-text-secondary);
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- å·¦ä¾§èœå• -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">åº”ç”¨</h1>
            </div>
            <nav class="sidebar-menu" id="sidebarMenu">
                <!-- èœå•å†…å®¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
            </nav>
        </aside>

        <!-- å³ä¾§å†…å®¹åŒº -->
        <main class="main-content">
            <header class="content-header">
                <div class="breadcrumb-container">
                    <nav class="breadcrumb" id="breadcrumbNav" aria-label="é¢åŒ…å±‘å¯¼èˆª">
                        <!-- é¢åŒ…å±‘å†…å®¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </nav>
                </div>
                <div class="tabs-container">
                    <div class="tabs-wrapper" id="tabsWrapper">
                        <!-- æ ‡ç­¾é¡µå†…å®¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                <div class="content-title-container">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <h2 class="content-title" id="contentTitle"></h2>
                        <a href="#" id="backToCardsBtn" class="back-to-cards-btn" onclick="goBackToCards(event)" style="display: none;">
                            <span style="margin-right: 4px;">â†</span>
                            è¿”å›åº”ç”¨
                        </a>
                    </div>
                </div>
            </header>
            <div class="content-body" id="contentBody">
                <!-- æ¨¡å—å…¥å£å¡ç‰‡æ ‡é¢˜åŒºåŸŸå·²å»æ‰æ–‡å­—ï¼Œä¿ç•™å®¹å™¨ä»¥ä¾¿åç»­éœ€è¦æ—¶æ‰©å±• -->
                <div class="module-entry-header"></div>
                <div class="module-entry-grid" id="moduleEntryGrid">
                    <!-- å¡ç‰‡å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </main>
    </div>

    <script src="js/index.js"></script>
    <script>
        // æ¨¡å—å›¾æ ‡æ˜ å°„
        const moduleIcons = {
            'å•†è¶…': 'ğŸª',
            'æ”¶é“¶å°': 'ğŸ’³',
            'çº¿ä¸Šå•†åŸ': 'ğŸ›’',
            'è´¢åŠ¡ç®¡ç†': 'ğŸ’°',
            'é¤é¥®': 'ğŸ½ï¸'
        };

        // æ¸²æŸ“æ¨¡å—å¡ç‰‡
        function renderModuleCards() {
            const grid = document.getElementById('moduleEntryGrid');
            if (!grid) {
                console.error('æ‰¾ä¸åˆ°moduleEntryGridå…ƒç´ ');
                return;
            }
            
            grid.innerHTML = '';

            // è·å–æ‰€æœ‰æ¨¡å—æ•°æ®
            if (typeof menuData === 'undefined' || !menuData || menuData.length === 0) {
                grid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: var(--spacing-xl); color: var(--color-text-secondary);">æš‚æ— æ¨¡å—æ•°æ®</div>';
                return;
            }

            menuData.forEach(module => {
                const card = document.createElement('div');
                card.className = 'module-entry-card';
                card.dataset.moduleName = module.module;
                
                const icon = moduleIcons[module.module] || 'ğŸ“‹';
                const itemCount = module.items ? module.items.length : 0;
                const desc = itemCount > 0 ? `${itemCount} ä¸ªåŠŸèƒ½åˆ†ç±»` : 'ç‚¹å‡»è¿›å…¥';
                
                card.innerHTML = `
                    <span class="module-entry-card-icon">${icon}</span>
                    <h3 class="module-entry-card-title">${module.module}</h3>
                    <p class="module-entry-card-desc">${desc}</p>
                `;
                
                card.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('ç‚¹å‡»äº†å¡ç‰‡(æ–°çª—å£):', module.module);
                    const url = 'index.html?module=' + encodeURIComponent(module.module);
                    window.open(url, '_blank');
                });
                
                grid.appendChild(card);
            });
        }

        // è¿›å…¥æ¨¡å—èœå•é¡µé¢
        function enterModuleMenu(module) {
            console.log('è¿›å…¥æ¨¡å—èœå•:', module.module);
            
            const contentBody = document.getElementById('contentBody');
            const grid = document.getElementById('moduleEntryGrid');
            const header = document.querySelector('.module-entry-header');
            
            // éšè—å¡ç‰‡å’Œæ ‡é¢˜
            if (grid) grid.style.display = 'none';
            if (header) header.style.display = 'none';
            
            // éšè—å ä½ç¬¦
            const placeholder = document.getElementById('contentPlaceholder');
            if (placeholder) {
                placeholder.style.display = 'none';
            }
            
            // æ‰€æœ‰æ¨¡å—éƒ½ä½¿ç”¨æ–°å¸ƒå±€ï¼ˆä¸€çº§èœå•æ¨ªå‘ï¼Œå·¦ä¾§äºŒçº§èœå•ï¼Œå³ä¾§å†…å®¹ï¼‰
            renderSupermarketLayout(module);
            
            // æ›´æ–°å·¦ä¾§èœå•æç¤º
            const menuContainer = document.getElementById('sidebarMenu');
            if (menuContainer) {
                menuContainer.innerHTML = `<div style="padding: var(--spacing-md); color: var(--color-text-secondary); text-align: center;">${module.module}åŠŸèƒ½æ¨¡å—</div>`;
            }
            
            // æ›´æ–°æ ‡é¢˜
            const contentTitle = document.getElementById('contentTitle');
            if (contentTitle) {
                contentTitle.textContent = module.module;
            }
        }

        // æ¸²æŸ“æ¨¡å—çš„æ–°å¸ƒå±€ï¼ˆä¸€çº§èœå•æ¨ªå‘ï¼Œå·¦ä¾§äºŒçº§èœå•ï¼Œå³ä¾§å†…å®¹ï¼‰
        function renderSupermarketLayout(module) {
            const contentBody = document.getElementById('contentBody');
            
            // æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨å¸ƒå±€å®¹å™¨
            let layoutContainer = document.getElementById('moduleLayoutContainer');
            if (!layoutContainer) {
                layoutContainer = document.createElement('div');
                layoutContainer.id = 'moduleLayoutContainer';
                layoutContainer.className = 'module-layout-container';
                contentBody.appendChild(layoutContainer);
            }
            
            layoutContainer.innerHTML = '';
            
            // åˆ›å»ºä¸€çº§èœå•
            const level1Menu = document.createElement('div');
            level1Menu.className = 'level1-menu';
            level1Menu.id = 'level1Menu';
            
            module.items.forEach((item, index) => {
                const menuItem = document.createElement('button');
                menuItem.className = 'level1-menu-item' + (index === 0 ? ' active' : '');
                menuItem.textContent = item.title;
                menuItem.dataset.itemIndex = index;
                menuItem.dataset.itemTitle = item.title;
                
                menuItem.addEventListener('click', function() {
                    // åˆ‡æ¢ä¸€çº§èœå•æ¿€æ´»çŠ¶æ€
                    document.querySelectorAll('.level1-menu-item').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // æ›´æ–°äºŒçº§èœå•å’Œå†…å®¹
                    updateLevel2Menu(module, index);
                });
                
                level1Menu.appendChild(menuItem);
            });
            
            layoutContainer.appendChild(level1Menu);
            
            // åˆ›å»ºä¸»å†…å®¹åŒº
            const mainContentArea = document.createElement('div');
            mainContentArea.className = 'module-main-content-area';
            
            // åˆ›å»ºå·¦ä¾§äºŒçº§èœå•
            const level2Sidebar = document.createElement('div');
            level2Sidebar.className = 'level2-sidebar';
            level2Sidebar.id = 'level2Sidebar';
            
            // åˆ›å»ºå³ä¾§å†…å®¹åŒº
            const contentArea = document.createElement('div');
            contentArea.className = 'module-content-area';
            contentArea.id = 'moduleContentArea';
            
            mainContentArea.appendChild(level2Sidebar);
            mainContentArea.appendChild(contentArea);
            layoutContainer.appendChild(mainContentArea);
            
            // åˆå§‹åŒ–æ˜¾ç¤ºç¬¬ä¸€ä¸ªä¸€çº§èœå•çš„äºŒçº§èœå•
            if (module.items.length > 0) {
                updateLevel2Menu(module, 0);
            }
        }

        // æ›´æ–°äºŒçº§èœå•å’Œå†…å®¹
        function updateLevel2Menu(module, itemIndex) {
            const item = module.items[itemIndex];
            const level2Sidebar = document.getElementById('level2Sidebar');
            const contentArea = document.getElementById('moduleContentArea');
            
            if (!item || !level2Sidebar || !contentArea) return;
            
            // æ›´æ–°äºŒçº§èœå•æ ‡é¢˜
            level2Sidebar.innerHTML = '';
            const sidebarTitle = document.createElement('div');
            sidebarTitle.className = 'level2-sidebar-title';
            sidebarTitle.textContent = item.title;
            level2Sidebar.appendChild(sidebarTitle);
            
            // å¦‚æœæœ‰å­èœå•ï¼Œæ˜¾ç¤ºäºŒçº§èœå•é¡¹
            if (item.children && item.children.length > 0) {
                item.children.forEach((child, childIndex) => {
                    const sidebarItem = document.createElement('a');
                    sidebarItem.href = '#';
                    sidebarItem.className = 'level2-sidebar-item' + (childIndex === 0 ? ' active' : '');
                    sidebarItem.textContent = child.title;
                    sidebarItem.dataset.path = child.path;
                    sidebarItem.dataset.title = child.title;
                    
                    sidebarItem.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // åˆ‡æ¢äºŒçº§èœå•æ¿€æ´»çŠ¶æ€
                        document.querySelectorAll('.level2-sidebar-item').forEach(link => {
                            link.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        // åŠ è½½å†…å®¹
                        loadModulePage(child.path, child.title);
                    });
                    
                    level2Sidebar.appendChild(sidebarItem);
                });
                
                // é»˜è®¤åŠ è½½ç¬¬ä¸€ä¸ªå­èœå•çš„å†…å®¹
                if (item.children.length > 0) {
                    loadModulePage(item.children[0].path, item.children[0].title);
                }
            } else if (item.path) {
                // å¦‚æœæ²¡æœ‰å­èœå•ï¼Œç›´æ¥åŠ è½½é¡µé¢
                const sidebarItem = document.createElement('div');
                sidebarItem.className = 'level2-sidebar-item active';
                sidebarItem.textContent = item.title;
                sidebarItem.style.cursor = 'default';
                sidebarItem.style.pointerEvents = 'none';
                level2Sidebar.appendChild(sidebarItem);
                
                loadModulePage(item.path, item.title);
            }
        }

        // åŠ è½½æ¨¡å—é¡µé¢åˆ°å³ä¾§å†…å®¹åŒº
        function loadModulePage(path, title) {
            const contentArea = document.getElementById('moduleContentArea');
            if (!contentArea) return;
            
            // ç§»é™¤æ—§çš„iframe
            const oldIframe = contentArea.querySelector('.module-content-iframe');
            if (oldIframe) {
                oldIframe.remove();
            }
            
            // åˆ›å»ºæ–°çš„iframe
            const iframe = document.createElement('iframe');
            iframe.className = 'module-content-iframe';
            iframe.src = path;
            iframe.id = 'moduleContentIframe';
            contentArea.appendChild(iframe);
        }


        // è¿”å›åŠŸèƒ½æ¨¡å—å…¥å£ï¼ˆå¡ç‰‡é¡µé¢ï¼‰
        window.goBackToCards = function(event) {
            if (event) {
                event.preventDefault();
            }
            // è¿”å›åˆ°åº”ç”¨å…¥å£é¡µï¼ˆäº”ä¸ªå…¥å£ï¼‰
            window.location.href = 'index.html';
        };
        
        // é¡µé¢åŠ è½½å®Œæˆåæ¸²æŸ“å¡ç‰‡ï¼ˆä»…åœ¨æ— moduleå‚æ•°æ—¶ï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            const params = new URLSearchParams(window.location.search || '');
            const moduleName = params.get('module');
            if (!moduleName) {
                setTimeout(function() {
                    renderModuleCards();
                }, 100);
            }
        });
        
        // window.onloadæ—¶ä¹Ÿæ‰§è¡Œä¸€æ¬¡ï¼ˆä»…åœ¨æ— moduleå‚æ•°æ—¶ï¼‰
        window.addEventListener('load', function() {
            const params = new URLSearchParams(window.location.search || '');
            const moduleName = params.get('module');
            if (!moduleName) {
                setTimeout(function() {
                    renderModuleCards();
                }, 100);
            }
        });
    </script>
</body>
</html>
