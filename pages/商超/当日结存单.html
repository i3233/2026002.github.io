<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å½“æ—¥ç»“å­˜å• - 2026æ–°é¡¹ç›®äºŒ</title>
    <link rel="stylesheet" href="../../css/Main.css">
    <style>
        .daily-statement-page {
            padding: var(--spacing-lg);
            background-color: var(--color-neutral-50);
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-lg);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
        }

        .page-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0;
        }

        .page-subtitle {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin-top: var(--spacing-xs);
        }

        /* ç­›é€‰å·¥å…·æ  */
        .filter-toolbar {
            padding: var(--spacing-lg);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            margin-bottom: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .filter-item label {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
            white-space: nowrap;
        }

        .filter-item select,
        .filter-item input {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--color-neutral-300);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .filter-item select:focus,
        .filter-item input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: var(--shadow-input-focus);
        }

        /* ç»Ÿè®¡æ‘˜è¦åŒºåŸŸ */
        .summary-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        .summary-card {
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            padding: var(--spacing-md) var(--spacing-lg);
        }

        .summary-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
        }

        .summary-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .summary-icon {
            font-size: var(--font-size-xl);
            opacity: 0.3;
        }

        .summary-value {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--spacing-xs);
        }

        .summary-value-blue {
            color: var(--color-primary);
        }

        .summary-value-green {
            color: var(--color-success);
        }

        .summary-value-orange {
            color: #ff8c42;
        }

        .summary-value-red {
            color: var(--color-error);
        }

        .summary-change {
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
        }

        .summary-change.positive {
            color: var(--color-success);
        }

        .summary-change.negative {
            color: var(--color-error);
        }

        /* è¿›å­˜é”€ç»Ÿè®¡å¡ç‰‡ */
        .inventory-stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        .inventory-stat-card {
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            padding: var(--spacing-lg);
        }

        .inventory-stat-title {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid var(--color-neutral-200);
        }

        .inventory-stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--color-neutral-100);
        }

        .inventory-stat-row:last-child {
            border-bottom: none;
            font-weight: var(--font-weight-medium);
            padding-top: var(--spacing-sm);
            margin-top: var(--spacing-sm);
            border-top: 1px solid var(--color-neutral-200);
        }

        .inventory-stat-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .inventory-stat-value {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
        }

        .inventory-stat-value.amount {
            color: var(--color-primary);
        }

        /* è¡¨æ ¼å®¹å™¨ */
        .table-container {
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            overflow: hidden;
        }

        .table-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--color-neutral-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0;
        }

        .table-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        .table-wrapper {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background-color: var(--color-neutral-50);
        }

        th, td {
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-sm);
            border-bottom: 1px solid var(--color-neutral-200);
            white-space: nowrap;
        }

        th {
            text-align: left;
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
        }

        th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: var(--spacing-xl);
        }

        th.sortable::after {
            content: 'â†•';
            position: absolute;
            right: var(--spacing-sm);
            color: var(--color-neutral-400);
            font-size: var(--font-size-xs);
        }

        th.sortable.asc::after {
            content: 'â†‘';
            color: var(--color-primary);
        }

        th.sortable.desc::after {
            content: 'â†“';
            color: var(--color-primary);
        }

        tbody tr:hover {
            background-color: var(--color-neutral-50);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .text-right {
            text-align: right;
        }

        .text-center {
            text-align: center;
        }

        .text-secondary {
            color: var(--color-text-secondary);
        }

        /* åˆè®¡è¡Œ */
        .table-footer-row {
            background-color: var(--color-neutral-50);
            font-weight: var(--font-weight-medium);
        }

        /* åº•éƒ¨å·¥å…·æ  */
        .bottom-toolbar {
            margin-top: var(--spacing-md);
            padding: var(--spacing-md) var(--spacing-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--spacing-md);
            background-color: #ffffff;
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            border-top: 1px solid var(--color-neutral-200);
        }

        .bottom-left,
        .bottom-right {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        /* åˆ†é¡µæ§ä»¶ */
        .page-size-select {
            padding: 2px 8px;
            border-radius: var(--radius-md);
            border: 1px solid var(--color-neutral-300);
            font-size: var(--font-size-xs);
        }

        .pagination-info {
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
        }

        .pagination-pages {
            display: inline-flex;
            align-items: center;
            gap: 2px;
        }

        .pagination-page-btn {
            min-width: 24px;
            padding: 2px 6px;
            border-radius: var(--radius-md);
            border: 1px solid var(--color-neutral-300);
            background-color: #ffffff;
            font-size: var(--font-size-xs);
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .pagination-page-btn.active {
            background-color: var(--color-primary);
            color: #ffffff;
            border-color: var(--color-primary);
        }

        .pagination-page-btn:hover:not(.active) {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .pagination-page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-jump-input {
            width: 40px;
            padding: 2px 4px;
            border-radius: var(--radius-md);
            border: 1px solid var(--color-neutral-300);
            font-size: var(--font-size-xs);
            text-align: center;
        }

        .btn-icon-text {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .btn-icon-text-symbol {
            font-size: 14px;
        }

        @media (max-width: 1200px) {
            .filter-toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-item {
                width: 100%;
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-xs);
            }

            .bottom-toolbar {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="daily-statement-page">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="page-header">
            <div>
                <h1 class="page-title">å½“æ—¥ç»“å­˜å•</h1>
                <div class="page-subtitle">æŸ¥çœ‹å½“æ—¥å•†å“çš„è¿›å­˜é”€æƒ…å†µå’Œç»“å­˜ä¿¡æ¯</div>
            </div>
        </div>

        <!-- ç­›é€‰å·¥å…·æ  -->
        <div class="filter-toolbar">
            <div class="filter-item">
                <label>æ—¥æœŸï¼š</label>
                <input type="date" id="statementDate" value="">
            </div>
            <div class="filter-item">
                <label>ä»“åº“ï¼š</label>
                <select id="warehouseSelect">
                    <option value="">å…¨éƒ¨ä»“åº“</option>
                    <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                </select>
            </div>
            <div class="filter-item">
                <label>åˆ†ç±»ï¼š</label>
                <select id="categorySelect">
                    <option value="">å…¨éƒ¨åˆ†ç±»</option>
                    <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                </select>
            </div>
            <button class="btn btn-primary" id="queryBtn">æŸ¥è¯¢</button>
            <button class="btn btn-outline" id="printBtn">
                <span class="btn-icon-text">
                    <span class="btn-icon-text-symbol">ğŸ–¨</span>
                    <span>æ‰“å°</span>
                </span>
            </button>
            <button class="btn btn-outline" id="exportBtn">
                <span class="btn-icon-text">
                    <span class="btn-icon-text-symbol">â†‘</span>
                    <span>å¯¼å‡º</span>
                </span>
            </button>
        </div>

        <!-- ç»Ÿè®¡æ‘˜è¦åŒºåŸŸ -->
        <div class="summary-section">
            <div class="summary-card">
                <div class="summary-card-header">
                    <span class="summary-label">ä»Šæ—¥è¿›è´§</span>
                    <span class="summary-icon">ğŸ“¦</span>
                </div>
                <div class="summary-value summary-value-blue" id="todayPurchaseAmount">Â¥0.00</div>
                <div class="summary-change" id="todayPurchaseChange">è¾ƒæ˜¨æ—¥: +0.00</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-header">
                    <span class="summary-label">ä»Šæ—¥é”€å”®</span>
                    <span class="summary-icon">ğŸ’°</span>
                </div>
                <div class="summary-value summary-value-green" id="todaySalesAmount">Â¥0.00</div>
                <div class="summary-change" id="todaySalesChange">è¾ƒæ˜¨æ—¥: +0.00</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-header">
                    <span class="summary-label">å½“å‰åº“å­˜</span>
                    <span class="summary-icon">ğŸ“Š</span>
                </div>
                <div class="summary-value summary-value-orange" id="currentInventoryQty">0</div>
                <div class="summary-change" id="currentInventoryChange">åº“å­˜é‡‘é¢: Â¥0.00</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-header">
                    <span class="summary-label">åº“å­˜é‡‘é¢</span>
                    <span class="summary-icon">ğŸ’µ</span>
                </div>
                <div class="summary-value summary-value-red" id="currentInventoryAmount">Â¥0.00</div>
                <div class="summary-change" id="currentInventoryAmountChange">è¾ƒæ˜¨æ—¥: +0.00</div>
            </div>
        </div>

        <!-- è¿›å­˜é”€ç»Ÿè®¡å¡ç‰‡ -->
        <div class="inventory-stats-section">
            <!-- è¿›è´§ç»Ÿè®¡ -->
            <div class="inventory-stat-card">
                <div class="inventory-stat-title">è¿›è´§ç»Ÿè®¡</div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">è¿›è´§å•æ•°</span>
                    <span class="inventory-stat-value" id="purchaseOrderCount">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">è¿›è´§æ•°é‡</span>
                    <span class="inventory-stat-value" id="purchaseQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">è¿›è´§é‡‘é¢</span>
                    <span class="inventory-stat-value amount" id="purchaseAmount">Â¥0.00</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é€€è´§å•æ•°</span>
                    <span class="inventory-stat-value" id="returnOrderCount">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é€€è´§æ•°é‡</span>
                    <span class="inventory-stat-value" id="returnQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é€€è´§é‡‘é¢</span>
                    <span class="inventory-stat-value amount" id="returnAmount">Â¥0.00</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">å‡€è¿›è´§</span>
                    <span class="inventory-stat-value amount" id="netPurchaseAmount">Â¥0.00</span>
                </div>
            </div>

            <!-- é”€å”®ç»Ÿè®¡ -->
            <div class="inventory-stat-card">
                <div class="inventory-stat-title">é”€å”®ç»Ÿè®¡</div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é”€å”®å•æ•°</span>
                    <span class="inventory-stat-value" id="salesOrderCount">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é”€å”®æ•°é‡</span>
                    <span class="inventory-stat-value" id="salesQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é”€å”®é‡‘é¢</span>
                    <span class="inventory-stat-value amount" id="salesAmount">Â¥0.00</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é€€è´§å•æ•°</span>
                    <span class="inventory-stat-value" id="salesReturnOrderCount">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é€€è´§æ•°é‡</span>
                    <span class="inventory-stat-value" id="salesReturnQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">é€€è´§é‡‘é¢</span>
                    <span class="inventory-stat-value amount" id="salesReturnAmount">Â¥0.00</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">å‡€é”€å”®</span>
                    <span class="inventory-stat-value amount" id="netSalesAmount">Â¥0.00</span>
                </div>
            </div>

            <!-- åº“å­˜ç»Ÿè®¡ -->
            <div class="inventory-stat-card">
                <div class="inventory-stat-title">åº“å­˜ç»Ÿè®¡</div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">æœŸåˆåº“å­˜</span>
                    <span class="inventory-stat-value" id="beginningInventoryQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">æœŸåˆé‡‘é¢</span>
                    <span class="inventory-stat-value amount" id="beginningInventoryAmount">Â¥0.00</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">æœ¬æœŸå…¥åº“</span>
                    <span class="inventory-stat-value" id="currentInQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">æœ¬æœŸå‡ºåº“</span>
                    <span class="inventory-stat-value" id="currentOutQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">è°ƒæ‹¨å…¥åº“</span>
                    <span class="inventory-stat-value" id="transferInQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">è°ƒæ‹¨å‡ºåº“</span>
                    <span class="inventory-stat-value" id="transferOutQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">æœŸæœ«åº“å­˜</span>
                    <span class="inventory-stat-value" id="endingInventoryQty">0</span>
                </div>
                <div class="inventory-stat-row">
                    <span class="inventory-stat-label">æœŸæœ«é‡‘é¢</span>
                    <span class="inventory-stat-value amount" id="endingInventoryAmount">Â¥0.00</span>
                </div>
            </div>
        </div>

        <!-- å•†å“ç»“å­˜æ˜ç»†è¡¨æ ¼ -->
        <div class="table-container">
            <div class="table-header">
                <h3 class="table-title">å•†å“ç»“å­˜æ˜ç»†</h3>
                <div class="table-actions">
                    <button class="btn btn-outline" id="refreshBtn">åˆ·æ–°</button>
                </div>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th class="text-center">åºå·</th>
                            <th>äº§å“ID</th>
                            <th class="sortable" data-sort="name">äº§å“åç§°</th>
                            <th>è§„æ ¼å‹å·</th>
                            <th>åˆ†ç±»</th>
                            <th class="text-right">æœŸåˆåº“å­˜</th>
                            <th class="text-right">æœ¬æœŸå…¥åº“</th>
                            <th class="text-right">æœ¬æœŸå‡ºåº“</th>
                            <th class="text-right">è°ƒæ‹¨å…¥åº“</th>
                            <th class="text-right">è°ƒæ‹¨å‡ºåº“</th>
                            <th class="text-right sortable" data-sort="inventory">æœŸæœ«åº“å­˜</th>
                            <th class="text-right">å•ä½</th>
                            <th class="text-right">å¹³å‡æˆæœ¬</th>
                            <th class="text-right">åº“å­˜é‡‘é¢</th>
                        </tr>
                    </thead>
                    <tbody id="statementTableBody">
                        <!-- JS æ¸²æŸ“ -->
                    </tbody>
                    <tfoot>
                        <tr class="table-footer-row">
                            <td colspan="5" class="text-right">åˆè®¡ï¼š</td>
                            <td class="text-right" id="totalBeginningQty">0</td>
                            <td class="text-right" id="totalInQty">0</td>
                            <td class="text-right" id="totalOutQty">0</td>
                            <td class="text-right" id="totalTransferInQty">0</td>
                            <td class="text-right" id="totalTransferOutQty">0</td>
                            <td class="text-right" id="totalEndingQty">0</td>
                            <td colspan="2"></td>
                            <td class="text-right" id="totalInventoryAmount">Â¥0.00</td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <!-- åº•éƒ¨å·¥å…·æ  -->
            <div class="bottom-toolbar">
                <!-- å·¦ä¾§ä¿¡æ¯ -->
                <div class="bottom-left">
                    <span class="pagination-info">å…± <span id="totalRecords">0</span> æ¡è®°å½•</span>
                </div>

                <!-- å³ä¾§åˆ†é¡µ -->
                <div class="bottom-right">
                    <select class="page-size-select" id="pageSizeSelect">
                        <option value="20" selected>20 æ¡/é¡µ</option>
                        <option value="50">50 æ¡/é¡µ</option>
                        <option value="100">100 æ¡/é¡µ</option>
                    </select>
                    <div class="pagination-pages" id="paginationPages">
                        <!-- åˆ†é¡µæŒ‰é’®ç”±JSç”Ÿæˆ -->
                    </div>
                    <span class="pagination-info">è·³è½¬åˆ°</span>
                    <input type="number" class="pagination-jump-input" min="1" value="1" id="jumpToPage">
                    <span class="pagination-info">é¡µ</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿä»“åº“æ•°æ®
        const warehouses = [
            { id: 'WH001', name: 'ä¸»ä»“åº“' },
            { id: 'WH002', name: 'åˆ†ä»“åº“A' },
            { id: 'WH003', name: 'åˆ†ä»“åº“B' },
            { id: 'WH004', name: 'ä¸´æ—¶ä»“åº“' }
        ];

        // æ¨¡æ‹Ÿåˆ†ç±»æ•°æ®
        const categories = [
            { id: 'CAT001', name: 'å¨æˆ¿ç”¨å“' },
            { id: 'CAT002', name: 'æ—¥ç”¨å“' },
            { id: 'CAT003', name: 'é£Ÿå“' },
            { id: 'CAT004', name: 'é¥®æ–™' },
            { id: 'CAT005', name: 'å…¶ä»–' }
        ];

        // æ¨¡æ‹Ÿå½“æ—¥ç»“å­˜æ•°æ®
        const dailyStatementData = [
            {
                id: 'PRD001',
                name: 'éš”çƒ­å«',
                spec: '30cmÃ—30cm',
                category: 'å¨æˆ¿ç”¨å“',
                unit: 'ä¸ª',
                beginningQty: 120,
                beginningAmount: 1500.00,
                inQty: 50,
                outQty: 43,
                transferInQty: 10,
                transferOutQty: 5,
                endingQty: 132,
                avgCost: 12.50,
                inventoryAmount: 1650.00
            },
            {
                id: 'PRD002',
                name: 'p-6ç‚’é”…',
                spec: '32cm',
                category: 'å¨æˆ¿ç”¨å“',
                unit: 'ä¸ª',
                beginningQty: 85,
                beginningAmount: 13430.00,
                inQty: 20,
                outQty: 18,
                transferInQty: 0,
                transferOutQty: 2,
                endingQty: 85,
                avgCost: 158.00,
                inventoryAmount: 13430.00
            },
            {
                id: 'PRD003',
                name: 'é›…å®‰èŒ¶å¶',
                spec: '500g/ç›’',
                category: 'é£Ÿå“',
                unit: 'ç›’',
                beginningQty: 150,
                beginningAmount: 6750.00,
                inQty: 100,
                outQty: 120,
                transferInQty: 5,
                transferOutQty: 0,
                endingQty: 135,
                avgCost: 45.00,
                inventoryAmount: 6075.00
            },
            {
                id: 'PRD004',
                name: 'é›…å®‰èŠ±æ¤’',
                spec: '250g/è¢‹',
                category: 'é£Ÿå“',
                unit: 'è¢‹',
                beginningQty: 200,
                beginningAmount: 5600.00,
                inQty: 150,
                outQty: 180,
                transferInQty: 0,
                transferOutQty: 10,
                endingQty: 160,
                avgCost: 28.00,
                inventoryAmount: 4480.00
            },
            {
                id: 'PRD005',
                name: 'é›…å®‰è…Šè‚‰',
                spec: '500g/åŒ…',
                category: 'é£Ÿå“',
                unit: 'åŒ…',
                beginningQty: 80,
                beginningAmount: 3040.00,
                inQty: 50,
                outQty: 45,
                transferInQty: 0,
                transferOutQty: 0,
                endingQty: 85,
                avgCost: 38.00,
                inventoryAmount: 3230.00
            },
            {
                id: 'PRD006',
                name: 'ç†ŠçŒ«ç©å¶',
                spec: '20cm',
                category: 'å…¶ä»–',
                unit: 'ä¸ª',
                beginningQty: 400,
                beginningAmount: 6000.00,
                inQty: 200,
                outQty: 180,
                transferInQty: 0,
                transferOutQty: 0,
                endingQty: 420,
                avgCost: 15.00,
                inventoryAmount: 6300.00
            },
            {
                id: 'PRD007',
                name: 'é›…å®‰æ˜ä¿¡ç‰‡',
                spec: 'ä¸€å¥—10å¼ ',
                category: 'å…¶ä»–',
                unit: 'å¥—',
                beginningQty: 800,
                beginningAmount: 9600.00,
                inQty: 300,
                outQty: 280,
                transferInQty: 0,
                transferOutQty: 0,
                endingQty: 820,
                avgCost: 12.00,
                inventoryAmount: 9840.00
            },
            {
                id: 'PRD008',
                name: 'é›…å®‰ç‰¹äº§ç¤¼ç›’',
                spec: '1kgè£…',
                category: 'é£Ÿå“',
                unit: 'ç›’',
                beginningQty: 100,
                beginningAmount: 8800.00,
                inQty: 80,
                outQty: 75,
                transferInQty: 0,
                transferOutQty: 0,
                endingQty: 105,
                avgCost: 88.00,
                inventoryAmount: 9240.00
            },
            {
                id: 'PRD009',
                name: 'é›…å®‰èœ‚èœœ',
                spec: '500g/ç“¶',
                category: 'é£Ÿå“',
                unit: 'ç“¶',
                beginningQty: 150,
                beginningAmount: 5250.00,
                inQty: 100,
                outQty: 95,
                transferInQty: 0,
                transferOutQty: 0,
                endingQty: 155,
                avgCost: 35.00,
                inventoryAmount: 5425.00
            },
            {
                id: 'PRD010',
                name: 'ä¸é”ˆé’¢æ°´æ¯',
                spec: '500ml',
                category: 'æ—¥ç”¨å“',
                unit: 'ä¸ª',
                beginningQty: 250,
                beginningAmount: 6250.00,
                inQty: 100,
                outQty: 90,
                transferInQty: 0,
                transferOutQty: 0,
                endingQty: 260,
                avgCost: 25.00,
                inventoryAmount: 6500.00
            }
        ];

        // å½“å‰çŠ¶æ€
        let filteredData = [...dailyStatementData];
        let currentPage = 1;
        let pageSize = 20;
        let sortColumn = null;
        let sortDirection = 'asc';

        // åˆå§‹åŒ–
        function init() {
            // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('statementDate').value = today;

            // åˆå§‹åŒ–ä»“åº“é€‰æ‹©å™¨
            const warehouseSelect = document.getElementById('warehouseSelect');
            warehouses.forEach(warehouse => {
                const option = document.createElement('option');
                option.value = warehouse.id;
                option.textContent = warehouse.name;
                warehouseSelect.appendChild(option);
            });

            // åˆå§‹åŒ–åˆ†ç±»é€‰æ‹©å™¨
            const categorySelect = document.getElementById('categorySelect');
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });

            // åŠ è½½æ•°æ®
            loadStatementData();
        }

        // åŠ è½½ç»“å­˜æ•°æ®
        function loadStatementData() {
            // è®¡ç®—ç»Ÿè®¡æ•°æ®
            calculateStatistics();
            
            // æ¸²æŸ“è¡¨æ ¼
            renderTable();
        }

        // è®¡ç®—ç»Ÿè®¡æ•°æ®
        function calculateStatistics() {
            // ä»Šæ—¥è¿›è´§ç»Ÿè®¡
            const purchaseOrderCount = 8;
            const purchaseQty = filteredData.reduce((sum, item) => sum + item.inQty, 0);
            const purchaseAmount = 12500.00;
            const returnOrderCount = 2;
            const returnQty = 15;
            const returnAmount = 450.00;
            const netPurchaseAmount = purchaseAmount - returnAmount;

            // ä»Šæ—¥é”€å”®ç»Ÿè®¡
            const salesOrderCount = 25;
            const salesQty = filteredData.reduce((sum, item) => sum + item.outQty, 0);
            const salesAmount = 18500.00;
            const salesReturnOrderCount = 1;
            const salesReturnQty = 5;
            const salesReturnAmount = 150.00;
            const netSalesAmount = salesAmount - salesReturnAmount;

            // åº“å­˜ç»Ÿè®¡
            const beginningInventoryQty = filteredData.reduce((sum, item) => sum + item.beginningQty, 0);
            const beginningInventoryAmount = filteredData.reduce((sum, item) => sum + item.beginningAmount, 0);
            const currentInQty = filteredData.reduce((sum, item) => sum + item.inQty, 0);
            const currentOutQty = filteredData.reduce((sum, item) => sum + item.outQty, 0);
            const transferInQty = filteredData.reduce((sum, item) => sum + item.transferInQty, 0);
            const transferOutQty = filteredData.reduce((sum, item) => sum + item.transferOutQty, 0);
            const endingInventoryQty = filteredData.reduce((sum, item) => sum + item.endingQty, 0);
            const endingInventoryAmount = filteredData.reduce((sum, item) => sum + item.inventoryAmount, 0);

            // æ›´æ–°ç»Ÿè®¡æ‘˜è¦
            document.getElementById('todayPurchaseAmount').textContent = 'Â¥' + purchaseAmount.toFixed(2);
            document.getElementById('todayPurchaseChange').textContent = 'è¾ƒæ˜¨æ—¥: +' + (purchaseAmount * 0.1).toFixed(2);
            document.getElementById('todaySalesAmount').textContent = 'Â¥' + salesAmount.toFixed(2);
            document.getElementById('todaySalesChange').textContent = 'è¾ƒæ˜¨æ—¥: +' + (salesAmount * 0.15).toFixed(2);
            document.getElementById('currentInventoryQty').textContent = endingInventoryQty;
            document.getElementById('currentInventoryChange').textContent = 'åº“å­˜é‡‘é¢: Â¥' + endingInventoryAmount.toFixed(2);
            document.getElementById('currentInventoryAmount').textContent = 'Â¥' + endingInventoryAmount.toFixed(2);
            document.getElementById('currentInventoryAmountChange').textContent = 'è¾ƒæ˜¨æ—¥: +' + ((endingInventoryAmount - beginningInventoryAmount) * 0.05).toFixed(2);

            // æ›´æ–°è¿›å­˜é”€ç»Ÿè®¡
            document.getElementById('purchaseOrderCount').textContent = purchaseOrderCount;
            document.getElementById('purchaseQty').textContent = purchaseQty;
            document.getElementById('purchaseAmount').textContent = 'Â¥' + purchaseAmount.toFixed(2);
            document.getElementById('returnOrderCount').textContent = returnOrderCount;
            document.getElementById('returnQty').textContent = returnQty;
            document.getElementById('returnAmount').textContent = 'Â¥' + returnAmount.toFixed(2);
            document.getElementById('netPurchaseAmount').textContent = 'Â¥' + netPurchaseAmount.toFixed(2);

            document.getElementById('salesOrderCount').textContent = salesOrderCount;
            document.getElementById('salesQty').textContent = salesQty;
            document.getElementById('salesAmount').textContent = 'Â¥' + salesAmount.toFixed(2);
            document.getElementById('salesReturnOrderCount').textContent = salesReturnOrderCount;
            document.getElementById('salesReturnQty').textContent = salesReturnQty;
            document.getElementById('salesReturnAmount').textContent = 'Â¥' + salesReturnAmount.toFixed(2);
            document.getElementById('netSalesAmount').textContent = 'Â¥' + netSalesAmount.toFixed(2);

            document.getElementById('beginningInventoryQty').textContent = beginningInventoryQty;
            document.getElementById('beginningInventoryAmount').textContent = 'Â¥' + beginningInventoryAmount.toFixed(2);
            document.getElementById('currentInQty').textContent = currentInQty;
            document.getElementById('currentOutQty').textContent = currentOutQty;
            document.getElementById('transferInQty').textContent = transferInQty;
            document.getElementById('transferOutQty').textContent = transferOutQty;
            document.getElementById('endingInventoryQty').textContent = endingInventoryQty;
            document.getElementById('endingInventoryAmount').textContent = 'Â¥' + endingInventoryAmount.toFixed(2);
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const tbody = document.getElementById('statementTableBody');
            tbody.innerHTML = '';

            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="14" style="text-align: center; padding: var(--spacing-lg); color: var(--color-text-secondary);">æš‚æ— æ•°æ®</td></tr>';
                updateTotals();
                updatePagination(0, 1);
                return;
            }

            // æ’åº
            if (sortColumn) {
                filteredData.sort((a, b) => {
                    let aVal = a[sortColumn];
                    let bVal = b[sortColumn];
                    if (sortColumn === 'inventory') {
                        aVal = a.endingQty;
                        bVal = b.endingQty;
                    }
                    if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;
                    if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;
                    return 0;
                });
            }

            // åˆ†é¡µ
            const totalPages = Math.ceil(filteredData.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = startIndex + pageSize;
            const pageData = filteredData.slice(startIndex, endIndex);

            pageData.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="text-center">${startIndex + index + 1}</td>
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>${item.spec}</td>
                    <td>${item.category}</td>
                    <td class="text-right">${item.beginningQty}</td>
                    <td class="text-right">${item.inQty}</td>
                    <td class="text-right">${item.outQty}</td>
                    <td class="text-right">${item.transferInQty}</td>
                    <td class="text-right">${item.transferOutQty}</td>
                    <td class="text-right">${item.endingQty}</td>
                    <td class="text-right">${item.unit}</td>
                    <td class="text-right">Â¥${item.avgCost.toFixed(2)}</td>
                    <td class="text-right">Â¥${item.inventoryAmount.toFixed(2)}</td>
                `;
                tbody.appendChild(row);
            });

            updateTotals();
            updatePagination(filteredData.length, totalPages);
        }

        // æ›´æ–°åˆè®¡
        function updateTotals() {
            const totalBeginningQty = filteredData.reduce((sum, item) => sum + item.beginningQty, 0);
            const totalInQty = filteredData.reduce((sum, item) => sum + item.inQty, 0);
            const totalOutQty = filteredData.reduce((sum, item) => sum + item.outQty, 0);
            const totalTransferInQty = filteredData.reduce((sum, item) => sum + item.transferInQty, 0);
            const totalTransferOutQty = filteredData.reduce((sum, item) => sum + item.transferOutQty, 0);
            const totalEndingQty = filteredData.reduce((sum, item) => sum + item.endingQty, 0);
            const totalInventoryAmount = filteredData.reduce((sum, item) => sum + item.inventoryAmount, 0);

            document.getElementById('totalBeginningQty').textContent = totalBeginningQty;
            document.getElementById('totalInQty').textContent = totalInQty;
            document.getElementById('totalOutQty').textContent = totalOutQty;
            document.getElementById('totalTransferInQty').textContent = totalTransferInQty;
            document.getElementById('totalTransferOutQty').textContent = totalTransferOutQty;
            document.getElementById('totalEndingQty').textContent = totalEndingQty;
            document.getElementById('totalInventoryAmount').textContent = 'Â¥' + totalInventoryAmount.toFixed(2);
        }

        // æ›´æ–°åˆ†é¡µ
        function updatePagination(totalRecords, totalPages) {
            document.getElementById('totalRecords').textContent = totalRecords;

            const paginationPages = document.getElementById('paginationPages');
            paginationPages.innerHTML = '';

            if (totalPages === 0) {
                return;
            }

            // ä¸Šä¸€é¡µ
            const prevBtn = document.createElement('button');
            prevBtn.className = 'pagination-page-btn';
            prevBtn.textContent = 'ä¸Šä¸€é¡µ';
            prevBtn.disabled = currentPage === 1;
            prevBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderTable();
                }
            });
            paginationPages.appendChild(prevBtn);

            // é¡µç æŒ‰é’®
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            if (endPage - startPage < maxVisiblePages - 1) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            if (startPage > 1) {
                const firstBtn = document.createElement('button');
                firstBtn.className = 'pagination-page-btn';
                firstBtn.textContent = '1';
                firstBtn.addEventListener('click', () => {
                    currentPage = 1;
                    renderTable();
                });
                paginationPages.appendChild(firstBtn);

                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'pagination-info';
                    ellipsis.textContent = '...';
                    paginationPages.appendChild(ellipsis);
                }
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = 'pagination-page-btn';
                if (i === currentPage) {
                    pageBtn.classList.add('active');
                }
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => {
                    currentPage = i;
                    renderTable();
                });
                paginationPages.appendChild(pageBtn);
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'pagination-info';
                    ellipsis.textContent = '...';
                    paginationPages.appendChild(ellipsis);
                }

                const lastBtn = document.createElement('button');
                lastBtn.className = 'pagination-page-btn';
                lastBtn.textContent = totalPages;
                lastBtn.addEventListener('click', () => {
                    currentPage = totalPages;
                    renderTable();
                });
                paginationPages.appendChild(lastBtn);
            }

            // ä¸‹ä¸€é¡µ
            const nextBtn = document.createElement('button');
            nextBtn.className = 'pagination-page-btn';
            nextBtn.textContent = 'ä¸‹ä¸€é¡µ';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTable();
                }
            });
            paginationPages.appendChild(nextBtn);
        }

        // ç­›é€‰æ•°æ®
        function filterData() {
            filteredData = [...dailyStatementData];

            // ä»“åº“ç­›é€‰
            const warehouseId = document.getElementById('warehouseSelect').value;
            // è¿™é‡Œå¯ä»¥æ ¹æ®ä»“åº“ç­›é€‰ï¼Œå½“å‰ç¤ºä¾‹æ•°æ®æ²¡æœ‰ä»“åº“å­—æ®µï¼Œæš‚æ—¶è·³è¿‡

            // åˆ†ç±»ç­›é€‰
            const categoryId = document.getElementById('categorySelect').value;
            if (categoryId) {
                const categoryName = categories.find(c => c.id === categoryId)?.name;
                if (categoryName) {
                    filteredData = filteredData.filter(item => item.category === categoryName);
                }
            }

            currentPage = 1;
            loadStatementData();
        }

        // æ’åº
        function sortData(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }

            // æ›´æ–°è¡¨å¤´æ’åºå›¾æ ‡
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('asc', 'desc');
            });
            const th = document.querySelector(`th.sortable[data-sort="${column}"]`);
            if (th) {
                th.classList.add(sortDirection);
            }

            renderTable();
        }

        // äº‹ä»¶ç»‘å®š
        document.getElementById('queryBtn').addEventListener('click', filterData);
        document.getElementById('printBtn').addEventListener('click', function() {
            alert('æ‰“å°å½“æ—¥ç»“å­˜å•ï¼ˆç¤ºä¾‹ï¼‰\næ­£åœ¨å‡†å¤‡æ‰“å°...');
        });
        document.getElementById('exportBtn').addEventListener('click', function() {
            alert('å¯¼å‡ºå½“æ—¥ç»“å­˜å•ï¼ˆç¤ºä¾‹ï¼‰\næ­£åœ¨å¯¼å‡ºExcelæ–‡ä»¶...');
        });
        document.getElementById('refreshBtn').addEventListener('click', function() {
            filterData();
        });

        // æ’åºäº‹ä»¶
        document.querySelectorAll('th.sortable').forEach(th => {
            th.addEventListener('click', function() {
                const column = this.dataset.sort;
                sortData(column);
            });
        });

        // åˆ†é¡µå¤§å°å˜åŒ–
        document.getElementById('pageSizeSelect').addEventListener('change', function() {
            pageSize = parseInt(this.value);
            currentPage = 1;
            renderTable();
        });

        // è·³è½¬é¡µé¢
        document.getElementById('jumpToPage').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const page = parseInt(this.value);
                const totalPages = Math.ceil(filteredData.length / pageSize);
                if (page >= 1 && page <= totalPages) {
                    currentPage = page;
                    renderTable();
                } else {
                    alert(`è¯·è¾“å…¥1-${totalPages}ä¹‹é—´çš„é¡µç `);
                }
            }
        });

        // åˆå§‹åŒ–
        init();
    </script>
</body>
</html>