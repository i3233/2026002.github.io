<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商品列表 - 2026新项目二</title>
    <link rel="stylesheet" href="../../css/Main.css">
    <style>
        /* 商品列表页面专用样式 */
        .product-list-page {
            padding: var(--spacing-lg);
            background-color: var(--color-neutral-50);
        }

        /* 页面头部 */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-lg);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
        }

        .page-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0;
        }

        .header-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        /* Tab标签导航 */
        .tabs-nav {
            display: flex;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-md);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
        }

        .tab-nav-item {
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            background-color: transparent;
            color: var(--color-text-secondary);
            font-size: var(--font-size-base);
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all var(--transition-base) var(--ease-in-out);
            position: relative;
        }

        .tab-nav-item:hover {
            background-color: var(--color-neutral-100);
            color: var(--color-text-primary);
        }

        .tab-nav-item.active {
            color: var(--color-primary);
            background-color: rgba(44, 131, 235, 0.1);
            font-weight: var(--font-weight-medium);
        }

        .tab-nav-item.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 2px;
            background-color: var(--color-primary);
            border-radius: var(--radius-full);
        }

        /* 筛选区域 */
        .filter-section {
            padding: var(--spacing-lg);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            margin-bottom: var(--spacing-lg);
        }

        .filter-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .filter-item {
            flex: 1;
            min-width: 200px;
        }

        .filter-item--category {
            flex: 0 0 auto;
            min-width: auto;
        }

        .filter-item label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
        }

        .filter-item input {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--color-neutral-300);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .filter-item input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: var(--shadow-input-focus);
        }

        .category-filter-btn {
            margin-top: var(--spacing-xs);
        }

        .category-tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-xs);
            margin-top: var(--spacing-sm);
        }

        .category-selected-tag {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-xs) var(--spacing-sm);
            background-color: rgba(44, 131, 235, 0.1);
            color: var(--color-primary);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-sm);
        }

        .category-selected-tag .close-btn {
            cursor: pointer;
            width: 16px;
            height: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .category-selected-tag .close-btn:hover {
            background-color: var(--color-primary);
            color: #ffffff;
        }

        /* 弹窗遮罩 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: var(--z-index-modal-backdrop);
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        /* 弹窗 */
        .modal {
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            padding: var(--spacing-lg);
            min-width: 400px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            z-index: var(--z-index-modal);
        }

        /* 批量修改弹窗固定宽度 */
        #batchEditModalOverlay .modal {
            width: 1000px;
            max-width: none;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-neutral-200);
        }

        .modal-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            background-color: transparent;
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all var(--transition-base) var(--ease-in-out);
            color: var(--color-text-secondary);
        }

        .modal-close:hover {
            background-color: var(--color-neutral-100);
            color: var(--color-text-primary);
        }

        .modal-body {
            margin-bottom: var(--spacing-lg);
        }

        .category-checkbox-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            transition: all var(--transition-base) var(--ease-in-out);
            cursor: pointer;
        }

        .category-checkbox-item:hover {
            background-color: var(--color-neutral-50);
        }

        .category-checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: var(--spacing-sm);
            cursor: pointer;
        }

        .category-checkbox-item label {
            flex: 1;
            cursor: pointer;
            margin: 0;
            font-size: var(--font-size-base);
            color: var(--color-text-primary);
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
            padding-top: var(--spacing-md);
            border-top: 1px solid var(--color-neutral-200);
        }

        /* 批量修改弹窗布局 */
        .batch-edit-layout {
            display: flex;
            gap: var(--spacing-lg);
            min-height: 260px;
        }

        .batch-edit-sidebar {
            width: 130px;
            border-right: 1px solid var(--color-neutral-200);
            padding-right: var(--spacing-md);
        }

        .batch-edit-menu {
            list-style: none;
        }

        .batch-edit-menu-item {
            padding: 8px 4px;
            cursor: pointer;
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            border-radius: var(--radius-sm);
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .batch-edit-menu-item:hover {
            background-color: var(--color-neutral-50);
            color: var(--color-text-primary);
        }

        .batch-edit-menu-item.active {
            background-color: rgba(44, 131, 235, 0.1);
            color: var(--color-primary);
            font-weight: var(--font-weight-medium);
        }

        .batch-edit-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .batch-edit-content-title {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
        }

        .batch-edit-content-desc {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .date-range {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .search-box {
            flex: 2;
            min-width: 300px;
        }

        .search-box input {
            width: 100%;
        }

        /* 批量操作区域 */
        .batch-actions {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            margin-bottom: var(--spacing-lg);
            align-items: center;
        }

        .batch-actions.hidden {
            display: none;
        }

        .selected-count {
            margin-right: var(--spacing-md);
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
        }

        /* 表格容器 */
        .table-container {
            background-color: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            overflow: hidden;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background-color: var(--color-neutral-50);
        }

        th {
            padding: var(--spacing-md);
            text-align: left;
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
            font-size: var(--font-size-sm);
            border-bottom: 2px solid var(--color-neutral-200);
            white-space: nowrap;
        }

        th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: var(--spacing-xl);
        }

        th.sortable:hover {
            background-color: var(--color-neutral-100);
        }

        th.sortable::after {
            content: '↕';
            position: absolute;
            right: var(--spacing-sm);
            color: var(--color-neutral-400);
            font-size: var(--font-size-xs);
        }

        th.sortable.asc::after {
            content: '↑';
            color: var(--color-primary);
        }

        th.sortable.desc::after {
            content: '↓';
            color: var(--color-primary);
        }

        td {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--color-neutral-200);
            font-size: var(--font-size-sm);
            color: var(--color-text-primary);
        }

        tbody tr:hover {
            background-color: var(--color-neutral-50);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        /* 复选框 */
        .checkbox-cell {
            width: 50px;
            text-align: center;
        }

        .checkbox-cell input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* 商品图片和名称 */
        .product-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .product-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: var(--radius-md);
            border: 1px solid var(--color-neutral-200);
        }

        .product-name {
            font-weight: var(--font-weight-medium);
            color: var(--color-text-primary);
            cursor: pointer;
        }

        .product-name:hover {
            color: var(--color-primary);
        }

        /* 分类标签 */
        .category-tag {
            display: inline-block;
            padding: var(--spacing-xs) var(--spacing-sm);
            background-color: #ff8c42;
            color: #ffffff;
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
        }

        /* 状态标签 */
        .status-tag {
            display: inline-block;
            padding: var(--spacing-xs) var(--spacing-sm);
            background-color: var(--color-primary);
            color: #ffffff;
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
        }

        .status-tag.sold-out {
            background-color: var(--color-error);
        }

        .status-tag.offline {
            background-color: var(--color-secondary);
        }

        /* 可编辑字段 */
        .editable-field {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            cursor: pointer;
        }

        .editable-field:hover {
            color: var(--color-primary);
        }

        .edit-icon {
            width: 14px;
            height: 14px;
            opacity: 0;
            transition: opacity var(--transition-base) var(--ease-in-out);
        }

        .editable-field:hover .edit-icon {
            opacity: 1;
        }

        .editable-input {
            border: 1px solid var(--color-primary);
            border-radius: var(--radius-sm);
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-size-sm);
            width: 80px;
        }

        /* 开关控件 */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--color-neutral-300);
            transition: var(--transition-base);
            border-radius: var(--radius-full);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: #ffffff;
            transition: var(--transition-base);
            border-radius: 50%;
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: var(--color-primary);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        /* 操作按钮 */
        .action-buttons {
            display: flex;
            gap: var(--spacing-xs);
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--color-neutral-300);
            background-color: transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .btn-icon:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .btn-icon.delete:hover {
            border-color: var(--color-error);
            color: var(--color-error);
        }

        .btn-icon svg {
            width: 16px;
            height: 16px;
        }

        /* 分页 */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-lg);
            background-color: #ffffff;
            border-top: 1px solid var(--color-neutral-200);
        }

        .pagination-info {
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
        }

        .pagination-controls {
            display: flex;
            gap: var(--spacing-xs);
        }

        .pagination-btn {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--color-neutral-300);
            background-color: #ffffff;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--font-size-sm);
            transition: all var(--transition-base) var(--ease-in-out);
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background-color: var(--color-primary);
            color: #ffffff;
            border-color: var(--color-primary);
        }

        /* 价格显示 */
        .price {
            color: var(--color-error);
            font-weight: var(--font-weight-medium);
        }

        /* 响应式 */
        @media (max-width: 1200px) {
            .filter-row {
                flex-direction: column;
            }

            .filter-item {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="product-list-page">
        <!-- 页面头部 -->
        <div class="page-header">
            <h1 class="page-title">商品列表</h1>
            <div class="header-actions">
                <button class="btn btn-primary" id="addProductBtn">添加商品</button>
                <button class="btn btn-primary">商品导出</button>
                <button class="btn btn-primary">更新销量</button>
            </div>
        </div>

        <!-- Tab标签导航 -->
        <div class="tabs-nav">
            <button class="tab-nav-item active" data-tab="all">全部</button>
            <button class="tab-nav-item" data-tab="selling">销售中</button>
            <button class="tab-nav-item" data-tab="offline">下架中</button>
            <button class="tab-nav-item" data-tab="soldout">售罄</button>
        </div>

        <!-- 筛选区域 -->
        <div class="filter-section">
            <div class="filter-row">
                <div class="filter-item filter-item--category">
                    <label>分类筛选</label>
                    <button class="btn btn-outline category-filter-btn" id="categoryFilterBtn">分类筛选</button>
                    <div class="category-tags-container" id="categoryTagsContainer"></div>
                </div>
                <div class="filter-item">
                    <label>添加时间</label>
                    <div class="date-range">
                        <input type="date" id="startDate" value="2025-01-01">
                        <span>至</span>
                        <input type="date" id="endDate" value="2025-12-31">
                    </div>
                </div>
                <div class="filter-item search-box">
                    <label>搜索</label>
                    <input type="text" id="searchInput" placeholder="支持输入商品ID、关键词、货号、条形码或名称搜索">
                </div>
            </div>
        </div>

        <!-- 批量操作区域 -->
        <div class="batch-actions hidden" id="batchActions">
            <span class="selected-count">已选择 <span id="selectedCount">0</span> 项</span>
            <button class="btn btn-outline">上架</button>
            <button class="btn btn-outline">下架</button>
            <button class="btn btn-outline">删除</button>
            <button class="btn btn-outline" id="batchEditBtn">批量设置</button>
        </div>

        <!-- 表格容器 -->
        <div class="table-container">
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th class="checkbox-cell">
                                <input type="checkbox" id="selectAll">
                            </th>
                            <th class="sortable" data-sort="id">ID</th>
                            <th>排序</th>
                            <th>分类</th>
                            <th>商品名称</th>
                            <th>售价</th>
                            <th>成本价</th>
                            <th>库存</th>
                            <th>已出售量</th>
                            <th>是否加入快速购买</th>
                            <th>添加时间</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="productTableBody">
                        <!-- 数据由JavaScript动态生成 -->
                    </tbody>
                </table>
            </div>
            <!-- 分页 -->
            <div class="pagination">
                <div class="pagination-info">
                    共 <span id="totalCount">8</span> 条数据，每页显示 10 条
                </div>
                <div class="pagination-controls">
                    <button class="pagination-btn" disabled>上一页</button>
                    <button class="pagination-btn active">1</button>
                    <button class="pagination-btn" disabled>下一页</button>
                </div>
            </div>
        </div>

        <!-- 分类选择弹窗 -->
        <div class="modal-overlay" id="categoryModalOverlay">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">选择分类</h3>
                    <button class="modal-close" id="modalClose">
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="category-checkbox-item">
                        <input type="checkbox" id="category1" value="雅安好物">
                        <label for="category1">雅安好物</label>
                    </div>
                    <div class="category-checkbox-item">
                        <input type="checkbox" id="category2" value="雅安好景">
                        <label for="category2">雅安好景</label>
                    </div>
                    <div class="category-checkbox-item">
                        <input type="checkbox" id="category3" value="文创产品">
                        <label for="category3">文创产品</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="modalCancel">取消</button>
                    <button class="btn btn-primary" id="modalConfirm">确定</button>
                </div>
            </div>
        </div>

        <!-- 批量修改弹窗 -->
        <div class="modal-overlay" id="batchEditModalOverlay">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">批量修改</h3>
                    <button class="modal-close" id="batchEditClose">
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: var(--spacing-xs);">已选商品 <span id="batchSelectedCount">0</span> 种</p>
                    <p class="text-secondary" style="font-size: var(--font-size-xs); margin-bottom: var(--spacing-md);">
                        注：每次只能修改一项，修改后点击确定即可生效。如需修改多项，需多次操作。
                    </p>
                    <div class="batch-edit-layout">
                        <aside class="batch-edit-sidebar">
                            <ul class="batch-edit-menu" id="batchEditMenu">
                                <li class="batch-edit-menu-item active" data-key="price">价格</li>
                                <li class="batch-edit-menu-item" data-key="freight">运费</li>
                                <li class="batch-edit-menu-item" data-key="freeShipping">包邮规则</li>
                                <li class="batch-edit-menu-item" data-key="point">积分</li>
                                <li class="batch-edit-menu-item" data-key="vip">会员</li>
                                <li class="batch-edit-menu-item" data-key="tag">商品标签</li>
                                <li class="batch-edit-menu-item" data-key="permission">浏览购买权限</li>
                                <li class="batch-edit-menu-item" data-key="service">商品服务</li>
                                <li class="batch-edit-menu-item" data-key="quickBuy">快速购买</li>
                                <li class="batch-edit-menu-item" data-key="negotiate">面议</li>
                                <li class="batch-edit-menu-item" data-key="category">分类</li>
                            </ul>
                        </aside>
                        <section class="batch-edit-content">
                            <div class="batch-edit-content-title" id="batchEditContentTitle">批量修改价格</div>
                            <div class="batch-edit-content-desc" id="batchEditContentDesc">
                                当前仅展示占位说明：这里将来是「价格」相关的批量修改表单内容。
                            </div>
                        </section>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="batchEditCancel">取消</button>
                    <button class="btn btn-primary" id="batchEditConfirm">确定</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 商品数据
        const products = [
            {
                id: 5940,
                sort: 100,
                category: '雅安好景',
                name: '熊猫基地',
                image: '../../images/01.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5941,
                sort: 100,
                category: '雅安好景',
                name: '碧峰峡风景区',
                image: '../../images/02.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5942,
                sort: 100,
                category: '雅安好景',
                name: '雨城廊桥',
                image: '../../images/03.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5943,
                sort: 100,
                category: '雅安好景',
                name: '荥经严道砂锅',
                image: '../../images/04.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5944,
                sort: 100,
                category: '雅安好景',
                name: '二郎山风景区',
                image: '../../images/05.jpg',
                price: 80.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5945,
                sort: 100,
                category: '雅安好景',
                name: '上里古镇',
                image: '../../images/06.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5946,
                sort: 100,
                category: '雅安好景',
                name: '蒙顶山风景区',
                image: '../../images/01.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            },
            {
                id: 5947,
                sort: 100,
                category: '雅安好景',
                name: '熊猫基地',
                image: '../../images/02.jpg',
                price: 0.00,
                costPrice: 0.00,
                stock: 100,
                sold: '0+0',
                quickBuy: false,
                addTime: '2025-08-26',
                status: 'selling'
            }
        ];

        let filteredProducts = [...products];
        let currentTab = 'all';
        let sortColumn = null;
        let sortDirection = 'asc';
        let selectedCategories = []; // 选中的分类数组

        // 渲染表格
        function renderTable() {
            const tbody = document.getElementById('productTableBody');
            tbody.innerHTML = '';

            filteredProducts.forEach(product => {
                const row = document.createElement('tr');
                row.dataset.id = product.id;
                
                row.innerHTML = `
                    <td class="checkbox-cell">
                        <input type="checkbox" class="row-checkbox" data-id="${product.id}">
                    </td>
                    <td>${product.id}</td>
                    <td>
                        <span class="editable-field" data-field="sort" data-id="${product.id}">
                            ${product.sort}
                            <svg class="edit-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
                            </svg>
                        </span>
                    </td>
                    <td><span class="category-tag">${product.category}</span></td>
                    <td>
                        <div class="product-info">
                            <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.src='../../images/01.jpg'">
                            <span class="product-name editable-field" data-field="name" data-id="${product.id}">
                                ${product.name}
                                <svg class="edit-icon" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
                                </svg>
                            </span>
                        </div>
                    </td>
                    <td>
                        <span class="editable-field price" data-field="price" data-id="${product.id}">
                            ¥${product.price.toFixed(2)}
                            <svg class="edit-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
                            </svg>
                        </span>
                    </td>
                    <td>
                        <span class="editable-field price" data-field="costPrice" data-id="${product.id}">
                            ¥${product.costPrice.toFixed(2)}
                            <svg class="edit-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
                            </svg>
                        </span>
                    </td>
                    <td>
                        <span class="editable-field" data-field="stock" data-id="${product.id}">
                            ${product.stock}
                            <svg class="edit-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
                            </svg>
                        </span>
                    </td>
                    <td>${product.sold}</td>
                    <td>
                        <label class="toggle-switch">
                            <input type="checkbox" class="quick-buy-toggle" data-id="${product.id}" ${product.quickBuy ? 'checked' : ''}>
                            <span class="toggle-slider"></span>
                        </label>
                    </td>
                    <td>${product.addTime}</td>
                    <td>
                        <span class="status-tag ${product.status === 'soldout' ? 'sold-out' : product.status === 'offline' ? 'offline' : ''}">
                            ${product.status === 'selling' ? '销售中' : product.status === 'offline' ? '下架中' : '售罄'}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon edit-btn" data-id="${product.id}" title="编辑">
                                <svg viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
                                </svg>
                            </button>
                            <button class="btn-icon copy-btn" data-id="${product.id}" title="复制">
                                <svg viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"/>
                                    <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"/>
                                </svg>
                            </button>
                            <button class="btn-icon delete delete-btn" data-id="${product.id}" title="删除">
                                <svg viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/>
                                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });

            updateSelectedCount();
        }

        // “添加商品”按钮：跳转到商品添加页面
        document.getElementById('addProductBtn').addEventListener('click', function () {
            window.location.href = '商品添加.html';
        });

        // Tab切换
        document.querySelectorAll('.tab-nav-item').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab-nav-item').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                currentTab = this.dataset.tab;
                filterProducts();
            });
        });

        // 渲染分类标签
        function renderCategoryTags() {
            const container = document.getElementById('categoryTagsContainer');
            container.innerHTML = '';
            
            selectedCategories.forEach(category => {
                const tag = document.createElement('div');
                tag.className = 'category-selected-tag';
                tag.innerHTML = `
                    <span>${category}</span>
                    <span class="close-btn" data-category="${category}">×</span>
                `;
                container.appendChild(tag);
            });

            // 更新按钮文本（始终显示“分类筛选”）
            const btn = document.getElementById('categoryFilterBtn');
            btn.textContent = '分类筛选';
        }

        // 筛选产品
        function filterProducts() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            filteredProducts = products.filter(product => {
                // Tab筛选
                if (currentTab === 'selling' && product.status !== 'selling') return false;
                if (currentTab === 'offline' && product.status !== 'offline') return false;
                if (currentTab === 'soldout' && product.status !== 'soldout') return false;

                // 分类筛选
                if (selectedCategories.length > 0 && !selectedCategories.includes(product.category)) {
                    return false;
                }

                // 搜索筛选
                if (search) {
                    const searchLower = search.toLowerCase();
                    if (!product.id.toString().includes(searchLower) &&
                        !product.name.toLowerCase().includes(searchLower)) {
                        return false;
                    }
                }

                // 日期筛选
                if (startDate && product.addTime < startDate) return false;
                if (endDate && product.addTime > endDate) return false;

                return true;
            });

            // 排序
            if (sortColumn) {
                filteredProducts.sort((a, b) => {
                    let aVal = a[sortColumn];
                    let bVal = b[sortColumn];
                    if (typeof aVal === 'string') {
                        aVal = aVal.toLowerCase();
                        bVal = bVal.toLowerCase();
                    }
                    if (sortDirection === 'asc') {
                        return aVal > bVal ? 1 : -1;
                    } else {
                        return aVal < bVal ? 1 : -1;
                    }
                });
            }

            renderTable();
            document.getElementById('totalCount').textContent = filteredProducts.length;
        }

        // 排序功能
        document.querySelectorAll('.sortable').forEach(th => {
            th.addEventListener('click', function() {
                const column = this.dataset.sort;
                if (sortColumn === column) {
                    sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    sortColumn = column;
                    sortDirection = 'asc';
                }

                document.querySelectorAll('.sortable').forEach(t => {
                    t.classList.remove('asc', 'desc');
                });
                this.classList.add(sortDirection);

                filterProducts();
            });
        });

        // 全选功能
        document.getElementById('selectAll').addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('.row-checkbox');
            checkboxes.forEach(cb => cb.checked = this.checked);
            updateSelectedCount();
        });

        // 行复选框变化
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('row-checkbox')) {
                updateSelectedCount();
                const allChecked = document.querySelectorAll('.row-checkbox:checked').length === filteredProducts.length;
                document.getElementById('selectAll').checked = allChecked && filteredProducts.length > 0;
            }
        });

        // 更新选中数量
        function updateSelectedCount() {
            const count = document.querySelectorAll('.row-checkbox:checked').length;
            document.getElementById('selectedCount').textContent = count;
            const batchActions = document.getElementById('batchActions');
            if (count > 0) {
                batchActions.classList.remove('hidden');
            } else {
                batchActions.classList.add('hidden');
            }
        }

        // 分类弹窗相关
        const categoryModal = document.getElementById('categoryModalOverlay');
        const categoryFilterBtn = document.getElementById('categoryFilterBtn');
        const modalClose = document.getElementById('modalClose');
        const modalCancel = document.getElementById('modalCancel');
        const modalConfirm = document.getElementById('modalConfirm');
        const categoryCheckboxes = document.querySelectorAll('.category-checkbox-item input[type="checkbox"]');

        // 打开弹窗
        categoryFilterBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            // 同步当前选中的分类到复选框
            categoryCheckboxes.forEach(checkbox => {
                checkbox.checked = selectedCategories.includes(checkbox.value);
            });
            categoryModal.classList.add('show');
        });

        // 关闭弹窗
        function closeModal() {
            categoryModal.classList.remove('show');
        }

        modalClose.addEventListener('click', closeModal);
        modalCancel.addEventListener('click', closeModal);

        // 点击遮罩关闭弹窗
        categoryModal.addEventListener('click', function(e) {
            if (e.target === categoryModal) {
                closeModal();
            }
        });

        // 确定按钮
        modalConfirm.addEventListener('click', function() {
            selectedCategories = [];
            categoryCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    selectedCategories.push(checkbox.value);
                }
            });
            renderCategoryTags();
            filterProducts();
            closeModal();
        });

        // 标签删除
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('close-btn') || e.target.closest('.close-btn')) {
                const closeBtn = e.target.classList.contains('close-btn') ? e.target : e.target.closest('.close-btn');
                const category = closeBtn.dataset.category;
                selectedCategories = selectedCategories.filter(c => c !== category);
                renderCategoryTags();
                filterProducts();
            }
        });

        // 批量修改弹窗相关
        const batchEditModal = document.getElementById('batchEditModalOverlay');
        const batchEditBtn = document.getElementById('batchEditBtn');
        const batchEditClose = document.getElementById('batchEditClose');
        const batchEditCancel = document.getElementById('batchEditCancel');
        const batchEditConfirm = document.getElementById('batchEditConfirm');
        const batchSelectedCountEl = document.getElementById('batchSelectedCount');
        const batchEditMenu = document.getElementById('batchEditMenu');
        const batchEditContentTitle = document.getElementById('batchEditContentTitle');
        const batchEditContentDesc = document.getElementById('batchEditContentDesc');

        const batchEditDescMap = {
            price: '当前仅展示占位说明：这里将来是「价格」相关的批量修改表单内容。',
            freight: '这里将来是「运费」相关的批量修改设置，比如统一运费模板。',
            freeShipping: '这里将来是「包邮规则」相关的批量配置区域。',
            point: '这里将来是「积分」相关的批量赠送/抵扣配置。',
            vip: '这里将来是「会员」相关的批量折扣或会员价设置。',
            tag: '这里将来是「商品标签」相关的批量打标操作。',
            permission: '这里将来是「浏览购买权限」相关的批量控制设置。',
            service: '这里将来是「商品服务」相关的批量勾选/取消服务内容。',
            quickBuy: '这里将来是「快速购买」相关的批量开关设置。',
            negotiate: '这里将来是「面议」相关的批量开关或提示内容。',
            category: '这里将来是「分类」相关的批量移动/变更操作。'
        };

        function openBatchEditModal() {
            const count = document.querySelectorAll('.row-checkbox:checked').length;
            if (count === 0) {
                alert('请先勾选要批量修改的商品。');
                return;
            }
            batchSelectedCountEl.textContent = count;
            batchEditModal.classList.add('show');
        }

        function closeBatchEditModal() {
            batchEditModal.classList.remove('show');
        }

        if (batchEditBtn) {
            batchEditBtn.addEventListener('click', openBatchEditModal);
        }

        if (batchEditClose) {
            batchEditClose.addEventListener('click', closeBatchEditModal);
        }

        if (batchEditCancel) {
            batchEditCancel.addEventListener('click', closeBatchEditModal);
        }

        if (batchEditConfirm) {
            batchEditConfirm.addEventListener('click', function () {
                // 占位逻辑：实际批量修改逻辑后续接入
                closeBatchEditModal();
            });
        }

        // 点击遮罩关闭批量修改弹窗
        batchEditModal.addEventListener('click', function (e) {
            if (e.target === batchEditModal) {
                closeBatchEditModal();
            }
        });

        // 左侧菜单切换
        if (batchEditMenu) {
            batchEditMenu.addEventListener('click', function (e) {
                const item = e.target.closest('.batch-edit-menu-item');
                if (!item) return;
                const key = item.dataset.key;
                if (!key) return;

                // 激活状态切换
                batchEditMenu.querySelectorAll('.batch-edit-menu-item').forEach(li => {
                    li.classList.toggle('active', li === item);
                });

                // 更新右侧标题和说明
                const titleMap = {
                    price: '批量修改价格',
                    freight: '批量修改运费',
                    freeShipping: '批量设置包邮规则',
                    point: '批量设置积分',
                    vip: '批量设置会员相关',
                    tag: '批量设置商品标签',
                    permission: '批量设置浏览购买权限',
                    service: '批量设置商品服务',
                    quickBuy: '批量设置快速购买',
                    negotiate: '批量设置面议',
                    category: '批量修改分类'
                };
                batchEditContentTitle.textContent = titleMap[key] || '批量修改';
                batchEditContentDesc.textContent = batchEditDescMap[key] || '';
            });
        }

        // 筛选事件
        document.getElementById('startDate').addEventListener('change', filterProducts);
        document.getElementById('endDate').addEventListener('change', filterProducts);
        document.getElementById('searchInput').addEventListener('input', filterProducts);

        // 可编辑字段
        document.addEventListener('click', function(e) {
            const editableField = e.target.closest('.editable-field');
            if (editableField && !editableField.querySelector('.editable-input')) {
                const field = editableField.dataset.field;
                const id = parseInt(editableField.dataset.id);
                const product = products.find(p => p.id === id);
                if (!product) return;

                const currentValue = product[field];
                const isPrice = field === 'price' || field === 'costPrice';
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'editable-input';
                input.value = isPrice ? currentValue.toFixed(2) : currentValue;
                input.style.width = isPrice ? '100px' : '80px';

                const originalText = editableField.innerHTML;
                editableField.innerHTML = '';
                editableField.appendChild(input);
                input.focus();
                input.select();

                const save = () => {
                    const newValue = isPrice ? parseFloat(input.value) || 0 : input.value;
                    product[field] = newValue;
                    filterProducts();
                };

                input.addEventListener('blur', save);
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        save();
                    }
                });
            }
        });

        // 快速购买开关
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('quick-buy-toggle')) {
                const id = parseInt(e.target.dataset.id);
                const product = products.find(p => p.id === id);
                if (product) {
                    product.quickBuy = e.target.checked;
                }
            }
        });

        // 操作按钮
        document.addEventListener('click', function(e) {
            if (e.target.closest('.edit-btn')) {
                const id = parseInt(e.target.closest('.edit-btn').dataset.id);
                alert(`编辑商品 ID: ${id}`);
            }
            if (e.target.closest('.copy-btn')) {
                const id = parseInt(e.target.closest('.copy-btn').dataset.id);
                alert(`复制商品 ID: ${id}`);
            }
            if (e.target.closest('.delete-btn')) {
                const id = parseInt(e.target.closest('.delete-btn').dataset.id);
                if (confirm(`确定要删除商品 ID: ${id} 吗？`)) {
                    const index = products.findIndex(p => p.id === id);
                    if (index > -1) {
                        products.splice(index, 1);
                        filterProducts();
                    }
                }
            }
        });

        // 初始化
        renderCategoryTags();
        renderTable();
    </script>
</body>
</html>
